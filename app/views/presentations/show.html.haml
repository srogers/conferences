.row
  .col-md-12
    = title "#{ @presentation.name }"
    %h4= @presentation.speakers.empty? ? "no speaker identified" : @presentation.speaker_names
    - if @presentation.conference.present?
      %h5
        Presented at:
        =link_to @presentation.conference.name, conference_path(@presentation.conference)

    %p= @presentation.description.try(:html_safe)

    %p
      Subject Area:
      = @presentation.tag_list.empty? ? '<i>none identified</i>'.html_safe : @presentation.tag_list.map{|t| link_to t, tag_path(t)}.join(', ').html_safe

    %p
      Parts:
      = @presentation.parts

    %p
      Duration:
      = @presentation.duration

    %p
      Publications:
      = @presentation.publications.empty? ? "Not yet available" : ""
      %ul
        - @presentation.publications.each do |publication|
          %li
            = format_and_date(publication)
            - if publication.notes.present?
              = " - #{ publication.notes }"

- if can? :edit, @presentation
  .row
    .col-md-12
      - if @presentation.conference.blank?
        %h5 Link to a Conference
        = simple_form_for @presentation do |f|
          = f.input :presentation_id, as: :hidden, input_html: { value: @presentation.id }
          = f.input :conference_id, collection: [['',0]], label: false, input_html: { data: { delimiter: ',', placeholder: "enter a conference year...", source: conferences_path(format: :json) }, class: "select2-autocomplete", id: "conference_picker" }
          = f.submit 'Add'

.row
  .col-md-12
    .form-actions
      - if can? :edit, @presentation
        = link_to "Edit", edit_presentation_path(@presentation), :class => "btn btn-secondary"
        - if request.referrer.split('?').first == new_presentation_url # ignore any trailing params
          = link_to "Add Another", new_presentation_path(conference_id: @presentation.conference_id), :class => "btn btn-secondary"
      = link_to "Manage Speakers", manage_speakers_presentation_path(@presentation), :class => "btn btn-secondary"
      = link_to "Manage Publications", manage_publications_presentation_path(@presentation), :class => "btn btn-secondary"
      = link_to "Done", @presentation.conference_id.present? ? conference_path(@presentation.conference_id) : presentations_path, :class => "btn btn-primary"
      .pull-right
        - if can? :destroy, @presentation
          = link_to icon('trash', '', class: 'fa-fw'), presentation_path(@presentation), :method => :delete, :class => "btn btn-danger", :data => { :confirm => 'Are you sure?' }, :post => true
