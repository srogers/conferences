- title 'Publications'
.row.listing-controls
  .col-md-4
    = form_for :search, html: { class: 'form-inline' }, url: publications_path, method: :get do |f|
      = text_field_tag :search_term, params[:search_term] || params[:tag]
      %span{style: 'margin-right: 5px;'}
      = button_tag type: 'submit', class: 'btn btn-primary btn-sm' do
        = icon('fas', 'search', class: 'fa-sm')
      - if params[:search_term].present?
        = link_to 'All', publications_path, class: "btn btn-sm btn-primary ml-2"

  .col-md-5
    %span.dropdown.show
      = link_to icon('fas', 'chart-bar', 'Chart It',   class: 'fa-sm'), '#', class: "btn btn-sm btn-primary dropdown-toggle", role: "button", id: "dropdownMenuLink", "data-toggle": "dropdown", "aria-haspopup": "true", "aria-expanded": false
      .dropdown-menu{ "aria-labelledby": "dropdownMenuLink" }
        = link_to icon('fas', 'chart-bar', 'by Format',  class: 'fa-sm'), '#', class: "dropdown-item"
        = link_to icon('fas', 'chart-bar', 'by Year',  class: 'fa-sm'), '#', class: "dropdown-item"
        = link_to icon('fas', 'chart-bar', 'Speakers', class: 'fa-sm'), chart_speakers_path(search_term: params[:search_term], user_id: params[:user_id]), class: "dropdown-item"

    - if current_user&.editor? || current_user&.admin?
      = link_to icon('fas', 'heart', class: 'fa-sm text-danger'), publications_path(search_term: params[:search_term], heart: 't'), class: "btn btn-sm btn-secondary"

  .col-md-3
    - if can? :create, Publication
      .float-right
        =link_to "Add Publication", new_publication_path, class: 'btn btn-sm btn-primary'

.row
  .col-md-12
    - if @publications.blank?
      - if params[:search_term].present? || params[:tag].present?
        %p No publications match that search term
      - else
        %p You haven't created any publications yet.
    - else
      %table.table
        = render :partial => "table_head"
        = render :partial => "publication", :collection => @publications

      = paginate @publications
