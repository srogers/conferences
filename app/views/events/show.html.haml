- content_for :head do
  = tag :link, rel: 'canonical', href: event_url(@conference)

- title @conference.name

= render partial: 'control_bar'

.row
  .col-md-12
    - if current_user
      .float-right
        - if current_user.attended? @conference
          %p
            = attendance_status_message(@conference)
            = link_to icon('far', 'trash-alt', class: 'fa-fw'), event_user_path(@conference_user), :method => :delete, :style => "color: #F00", :data => { :confirm => 'Remove your association with this conference?' }, :post => true
        - else
          = simple_form_for @conference_user, url: event_users_path do |f|
            = f.input :conference_id, as: :hidden, input_html: { value: @conference.id }
            = f.input :user_id, as: :hidden, input_html: { value:current_user.id }
            = f.submit attendance_status_message(@conference), class: 'button'
    %h5= @conference.event_type
.row.mt-1
  .col-md-12
    %div{style: 'line-height: 1.2rem; margin-bottom: 15px'}
      %div{style: 'font-size: 18pt; margin-bottom: 5px'}= @conference.name
      %div{style: 'font-size: 1rem'}= @conference.date_span
      %div{style: 'font-size: 1rem'}
        by
        = @conference.organizer&.name
    %p
      = location(@conference, :full)

.row.mt-1
  .col-md-12
    %b Description:
    - if @conference.description.blank?
      %br
      %i unavailable
      %br
    -else
      = safe_list_sanitizer.sanitize(@conference.description).try(:html_safe)
    %br
.row
  .col-md-12
    - if can? :create, Program
      .float-right
        = link_to "Add", new_event_program_path(@conference), class: 'btn btn-secondary btn-sm'
    %p
      %b Supplemental Info
      %br
      - if @conference.programs.present?
        %ul
          - @conference.programs.each do |program|
            .row
              .col-md-9
                %li= safe_list_sanitizer.sanitize(program.description).try(:html_safe)
              .col-md-3.text-right
                = linked_icon_for_program(program, link_classes: 'mr-2')
                - if can? :edit, Program
                  = link_to icon('far', 'edit', class: 'fa-fw fa-sm'), edit_event_program_path(@conference, program), class: "btn btn-xs btn-primary mr-1"
                - if can? :destroy, Program
                  = link_to icon('far', 'trash-alt', class: 'fa-fw fa-sm'), event_program_path(@conference, program), :method => :delete, class: "btn btn-xs btn-danger", :data => { :confirm => 'Are you sure?' }, :post => true
      - else
        %i none
    - if can? :edit, Conference
      %p
        %b Data entry completed:
        = @conference.completed ? icon('fas', 'check', :class => 'fa-lg fa-fw text-success') : tag.i('not yet')
    %p
      %b Members Attending:
      = @conference.users.length
      - if @conference.users.length > 0 && current_user
        %span.ml-3
          = link_to icon('fas', 'users', class: 'fa-fw'), event_users_path(conference_id: @conference.id, page: 1)

- if can?(:edit, @conference) && @conference.editors_notes.present?
  .row
    .col-md-12
      %p
        %b Editor's Notes
        = safe_list_sanitizer.sanitize(@conference.editors_notes).try(:html_safe)

.row
  .col-md-12
    %h4 Presentations
    - if @presentations.empty?
      %p None Yet
    - else
      = render :partial => "presentations_header"
      = render :partial => "presentations/presentation", :collection =>  @presentations
.row
  .col-md-12
    %p= fb_social_bar
